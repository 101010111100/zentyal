class: 'EBox::MailFilter'
depends:
    - firewall

models:
    - AmavisConfiguration
    - AmavisPolicy
    - VDomainsFilter
    - FileExtensionACL
    - MIMETypeACL
    - AntispamConfiguration
    - AntispamACL
    - AntispamTraining
    - AntispamVDomainACL
    - FilterDetails
    - FilterGraph
    - FilterReportOptions

composites:
    Amavis: [AmavisConfiguration, AmavisPolicy, VDomainsFilter]
    FileFilter: [FileExtensionACL, MIMETypeACL]
    Antispam: [AntispamConfiguration, AntispamACL, AntispamTraining]
    FilterReport: [FilterReportOptions, FilterGraph, FilterDetails]

modeldepends:
    VDomainsFilter:
        mail/VDomains: [vdomain]

foreign:
    VDomainsFilter: [AntispamVDomainACL]
